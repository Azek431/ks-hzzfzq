/**
 * åˆ—è¡¨ç›¸ä¼¼åº¦å¤šç»´åº¦åˆ†æå‡½æ•°ã€Auto.js Pro çŠ€ç‰›å¼•æ“ä¸“å±ã€‘
 * æ ¸å¿ƒå®šä½ï¼šæ¸¸æˆè¾…åŠ©åœºæ™¯ï¼ˆåƒç´ 0/1åˆ—è¡¨/è†æ£˜åæ ‡åˆ—è¡¨ï¼‰ä¸“ç”¨ï¼Œé¢‘æ¬¡åŒ¹é…æ³•+å…¨ç»´åº¦ç»Ÿè®¡ï¼Œæ€»æ•°ç›¸åŒå€¼ä¸åŒåˆ™ç›¸ä¼¼åº¦<1
 * æ ¸å¿ƒç‰¹æ€§ï¼š1.çº¯ES5è¯­æ³•æ— ES6ç‰¹æ€§ 2.æœ‰åº/æ— åºå¯åˆ‡æ¢ 3.è¶…å…¨20+ç»´åº¦ç»Ÿè®¡ 4.è‡ªåŠ¨è¿˜åŸå…ƒç´ åŸå§‹ç±»å‹ 5.é˜²NaN/é™¤æ•°ä¸º0å´©æºƒ 6.ç²¾å‡†å®šä½å·®å¼‚ä½ç½®/å…ƒç´ 
 * @param {Array} arr1 - å¾…å¯¹æ¯”åˆ—è¡¨1ã€æ¸¸æˆè¾…åŠ©å¸¸ç”¨ã€‘ï¼š0/1åƒç´ æ•°ç»„ã€è†æ£˜åæ ‡æ•°ç»„ã€æ¨¡æ¿ç´¢å¼•æ•°ç»„ï¼ˆæ”¯æŒæ•°å­—/å­—ç¬¦ä¸²/å¸ƒå°”ï¼‰
 * @param {Array} arr2 - å¾…å¯¹æ¯”åˆ—è¡¨2ï¼šæ•°æ®ç±»å‹éœ€ä¸arr1ä¸€è‡´ï¼Œå¦åˆ™åˆ¤å®šä¸ºä¸åŒå…ƒç´ 
 * @param {Object} options - é…ç½®é¡¹ï¼ˆå¯é€‰ï¼Œä¼ null/undefinedåˆ™é»˜è®¤æ— åºåŒ¹é…ï¼‰
 * @param {Boolean} options.isOrdered - æ˜¯å¦å¼€å¯æœ‰åºåŒ¹é…ã€å¿…é€‰å¸ƒå°”ã€‘ï¼štrue=é€ä½ä¸¥æ ¼åŒ¹é…ï¼ˆåƒç´ 0/1åˆ—è¡¨æ ¸å¿ƒç”¨æ³•ï¼Œå…³æ³¨ä½ç½®ï¼‰ï¼›false=æ— åºé¢‘æ¬¡åŒ¹é…ï¼ˆè†æ£˜åæ ‡åˆ—è¡¨æ ¸å¿ƒç”¨æ³•ï¼Œä»…å…³æ³¨å…ƒç´ ï¼‰
 * @returns {Object} è¶…å…¨ç»´åº¦ç»Ÿè®¡åˆ†æç»“æœï¼Œæ‰€æœ‰å­—æ®µå‡åšé˜²NaN/ç©ºå€¼å¤„ç†ï¼Œç›´æ¥ç”¨äºä¸šåŠ¡å±‚åˆ¤æ–­ï¼Œå­—æ®µåˆ†8å¤§æ¨¡å—æ¸…æ™°å½’ç±»ï¼Œè¯¦ç»†è¯´æ˜å¦‚ä¸‹ï¼š
 * ===================== ã€æ ¸å¿ƒç»“æœæ¨¡å—ã€‘- ä¸»åˆ¤æ–­ä¾æ® =====================
 * similarity: Number (0~1) æ ¸å¿ƒç›¸ä¼¼åº¦å€¼ï¼š1=å®Œå…¨åŒ¹é…ï¼Œ0=æ— ä»»ä½•åŒ¹é…ï¼Œæœ‰åº=é€ä½åŒ¹é…ç‡/æœ€å¤§é•¿åº¦ï¼Œæ— åº=åŒ¹é…é¢‘æ¬¡/å¹³å‡é•¿åº¦
 * isOrdered: Boolean æœ¬æ¬¡åŒ¹é…æ¨¡å¼ï¼šä¸å…¥å‚é…ç½®ä¸€è‡´ï¼Œæ ‡è®°æœ‰åº/æ— åº
 * analysisState: String åˆ†æçŠ¶æ€ï¼šsuccess=åˆ†æå®Œæˆï¼Œempty_both=åŒç©ºåˆ—è¡¨ï¼Œempty_single=å•ç©ºåˆ—è¡¨ï¼ˆå¿«é€Ÿåˆ¤æ–­å¼‚å¸¸åœºæ™¯ï¼‰
 * ===================== ã€æ€»æ•°ç»´åº¦æ¨¡å—ã€‘- åˆ—è¡¨é•¿åº¦åŸºç¡€ç»Ÿè®¡ =====================
 * len1: Number arr1æœ‰æ•ˆé•¿åº¦ï¼ˆéæ•°ç»„åˆ™ä¸º0ï¼Œè‡ªåŠ¨è¿‡æ»¤æ— æ•ˆå…¥å‚ï¼‰
 * len2: Number arr2æœ‰æ•ˆé•¿åº¦ï¼ˆåŒlen1è§„åˆ™ï¼‰
 * diffLen: Number é•¿åº¦å·®å€¼ç»å¯¹å€¼ï¼šMath.abs(len1-len2)ï¼Œåæ˜ é•¿åº¦å·®å¼‚
 * sameLenFlag: Boolean é•¿åº¦æ˜¯å¦ç›¸åŒï¼štrue=ç›¸åŒï¼Œfalse=ä¸åŒï¼ˆæ¸¸æˆè¾…åŠ©æ ¸å¿ƒåˆ¤æ–­ï¼šåƒç´ ç‚¹/è†æ£˜æ•°æ˜¯å¦ä¸€è‡´ï¼‰
 * totalItemCount: Number æ€»å…ƒç´ æ•°ï¼šlen1+len2ï¼Œä½œä¸ºå æ¯”/è¯¯å·®è®¡ç®—çš„åŸºç¡€
 * lenRatio: Number (0~1) é•¿åº¦æ¯”å€¼ï¼šMath.min(len1,len2)/Math.max(len1,len2)ï¼Œåæ˜ é•¿åº¦ä¸€è‡´æ€§ï¼ˆ1=é•¿åº¦å®Œå…¨ç›¸åŒï¼‰
 * ===================== ã€é¢‘ç‡ç»´åº¦æ¨¡å—ã€‘- å…ƒç´ å‡ºç°é¢‘æ¬¡ç»Ÿè®¡ =====================
 * freq1: Object arr1å…ƒç´ é¢‘æ¬¡æ˜ å°„è¡¨ï¼š{key:å…ƒç´ å€¼(å­—ç¬¦ä¸²), value:å‡ºç°æ¬¡æ•°}ï¼Œå¦‚[1,0,1]â†’{"1":2,"0":1}
 * freq2: Object arr2å…ƒç´ é¢‘æ¬¡æ˜ å°„è¡¨ï¼šæ ¼å¼åŒfreq1
 * matchFreq: Number å…±åŒå…ƒç´ åŒ¹é…é¢‘æ¬¡å’Œï¼šå¯¹æ¯ä¸ªå…±åŒå…ƒç´ ï¼Œå–ä¸¤è€…é¢‘æ¬¡çš„æœ€å°å€¼æ±‚å’Œï¼ˆæ ¸å¿ƒåŒ¹é…æŒ‡æ ‡ï¼Œå€¼è¶Šå¤§åŒ¹é…åº¦è¶Šé«˜ï¼‰
 * totalFreq1: Number arr1æ€»é¢‘æ¬¡ï¼šå³len1ï¼ˆé¢‘æ¬¡å’Œ=å…ƒç´ æ€»æ•°ï¼Œæ ¡éªŒç”¨ï¼‰
 * totalFreq2: Number arr2æ€»é¢‘æ¬¡ï¼šå³len2ï¼ˆåŒtotalFreq1è§„åˆ™ï¼‰
 * maxFreq1: Number arr1å…ƒç´ æœ€å¤§é¢‘æ¬¡ï¼šarr1ä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ çš„é¢‘æ¬¡ï¼ˆå¦‚[1,0,1]â†’2ï¼‰
 * maxFreq2: Number arr2å…ƒç´ æœ€å¤§é¢‘æ¬¡ï¼šæ ¼å¼åŒmaxFreq1
 * minFreq1: Number arr1å…ƒç´ æœ€å°é¢‘æ¬¡ï¼šarr1ä¸­å‡ºç°æ¬¡æ•°æœ€å°‘çš„å…ƒç´ çš„é¢‘æ¬¡ï¼ˆå¦‚[1,0,1]â†’1ï¼‰
 * minFreq2: Number arr2å…ƒç´ æœ€å°é¢‘æ¬¡ï¼šæ ¼å¼åŒminFreq1
 * ===================== ã€å·®å€¼ç»´åº¦æ¨¡å—ã€‘- å…ƒç´ /é¢‘æ¬¡å·®å¼‚ç²¾å‡†ç»Ÿè®¡ =====================
 * diffItemCount: Number æ€»å·®å¼‚å…ƒç´ æ•°ï¼šæœ‰åº=é€ä½ä¸åŒ¹é…æ•°+é•¿åˆ—è¡¨å¤šä½™æ•°ï¼›æ— åº=ç‹¬æœ‰å…ƒç´ æ•°ä¹‹å’Œï¼ˆå€¼è¶Šå¤§å·®å¼‚è¶Šå¤§ï¼‰
 * diffFreqSum: Number å…±åŒå…ƒç´ é¢‘æ¬¡å·®å€¼å’Œï¼šå¯¹æ¯ä¸ªå…±åŒå…ƒç´ ï¼Œå–é¢‘æ¬¡å·®å€¼çš„ç»å¯¹å€¼æ±‚å’Œï¼ˆåæ˜ å…±åŒå…ƒç´ çš„é¢‘æ¬¡å·®å¼‚ï¼‰
 * uniqueItem1: Array arr1ç‹¬æœ‰çš„å…ƒç´ åˆ—è¡¨ï¼šè‡ªåŠ¨è¿˜åŸåŸå§‹ç±»å‹ï¼ˆæ•°å­—/å¸ƒå°”/å­—ç¬¦ä¸²ï¼‰ï¼Œæ— åºæœ‰æ•ˆ/æœ‰åº=[]
 * uniqueItem2: Array arr2ç‹¬æœ‰çš„å…ƒç´ åˆ—è¡¨ï¼šæ ¼å¼åŒuniqueItem1ï¼Œæ— åºæœ‰æ•ˆ/æœ‰åº=[]
 * commonItems: Array å…±åŒå…ƒç´ åˆ—è¡¨ï¼šä¸¤ä¸ªåˆ—è¡¨éƒ½å«æœ‰çš„å…ƒç´ ï¼Œè‡ªåŠ¨è¿˜åŸåŸå§‹ç±»å‹ï¼Œæ— åºæœ‰æ•ˆ/æœ‰åº=[]
 * unmatchIndex: Array é€ä½ä¸åŒ¹é…ä½ç½®ç´¢å¼•ï¼šæœ‰åºåŒ¹é…ä¸“å±ï¼Œè®°å½•arr1/arr2é€ä½å¯¹æ¯”æ—¶ä¸åŒ¹é…çš„ä¸‹æ ‡ï¼ˆå¦‚[2,4]â†’ç¬¬2ã€4ä½åƒç´ ä¸åŒï¼Œç²¾å‡†å®šä½åƒç´ å·®å¼‚ï¼‰
 * ===================== ã€è¯¯å·®ç»´åº¦æ¨¡å—ã€‘- å„ç»´åº¦è¯¯å·®é‡åŒ–ï¼ˆ0~1ï¼Œå€¼è¶Šå¤§è¯¯å·®è¶Šå¤§ï¼‰ =====================
 * similarityError: Number æ ¸å¿ƒç›¸ä¼¼åº¦è¯¯å·®ç‡ï¼š1 - similarityï¼ˆç›´æ¥åæ˜ æ ¸å¿ƒç»“æœçš„è¯¯å·®ç¨‹åº¦ï¼‰
 * lenErrorRate: Number é•¿åº¦è¯¯å·®ç‡ï¼šdiffLen/totalItemCountï¼ˆæ€»å…ƒç´ æ•°ä¸º0åˆ™=0ï¼Œé¿å…NaNï¼‰
 * freqErrorRate: Number é¢‘æ¬¡è¯¯å·®ç‡ï¼šdiffFreqSum/æ€»å…±åŒé¢‘æ¬¡å’Œï¼ˆæ— å…±åŒå…ƒç´ åˆ™=1ï¼Œæœ‰åºåŒ¹é…=0ï¼‰
 * itemErrorRate: Number å…ƒç´ è¯¯å·®ç‡ï¼šdiffItemCount/totalItemCountï¼ˆæ€»å…ƒç´ æ•°ä¸º0åˆ™=0ï¼Œåæ˜ å…ƒç´ æ•´ä½“å·®å¼‚ï¼‰
 * ===================== ã€å æ¯”ç»´åº¦æ¨¡å—ã€‘- å„æ ¸å¿ƒæŒ‡æ ‡å æ¯”ç»Ÿè®¡ï¼ˆ0~1ï¼Œè¾…åŠ©ç²¾ç»†åŒ–åˆ¤æ–­ï¼‰ =====================
 * commonItemRatio: Number å…±åŒå…ƒç´ å æ¯”ï¼šå…±åŒå…ƒç´ æ•°/æ€»å…ƒç´ ç§ç±»æ•°ï¼ˆæ— å…ƒç´ åˆ™=0ï¼Œæ— åºæœ‰æ•ˆ/æœ‰åº=0ï¼‰
 * matchFreqRatio1: Number åŒ¹é…é¢‘æ¬¡å arr1æ€»é¢‘æ¬¡æ¯”ï¼šmatchFreq/len1ï¼ˆarr1ä¸ºç©ºåˆ™=0ï¼Œåæ˜ arr1çš„åŒ¹é…åº¦ï¼‰
 * matchFreqRatio2: Number åŒ¹é…é¢‘æ¬¡å arr2æ€»é¢‘æ¬¡æ¯”ï¼šmatchFreq/len2ï¼ˆarr2ä¸ºç©ºåˆ™=0ï¼Œåæ˜ arr2çš„åŒ¹é…åº¦ï¼‰
 * matchFreqRatioTotal: Number åŒ¹é…é¢‘æ¬¡å æ€»é¢‘æ¬¡æ¯”ï¼šmatchFreq/(len1+len2)ï¼ˆæ€»é¢‘æ¬¡ä¸º0åˆ™=0ï¼Œæ•´ä½“é¢‘æ¬¡åŒ¹é…å æ¯”ï¼‰
 * ===================== ã€ä¸€è‡´æ€§ç»´åº¦æ¨¡å—ã€‘- å„ç»´åº¦ä¸€è‡´æ€§ç³»æ•°ï¼ˆ0~1ï¼Œå€¼è¶Šå¤§ä¸€è‡´æ€§è¶Šé«˜ï¼‰ =====================
 * lenConsistency: Number é•¿åº¦ä¸€è‡´æ€§ç³»æ•°ï¼š1 - lenErrorRateï¼ˆç›´æ¥åæ˜ é•¿åº¦çš„ä¸€è‡´æ€§ï¼Œ1=é•¿åº¦å®Œå…¨ç›¸åŒï¼‰
 * freqConsistency: Number é¢‘æ¬¡ä¸€è‡´æ€§ç³»æ•°ï¼š1 - freqErrorRateï¼ˆæ— å…±åŒå…ƒç´ åˆ™=0ï¼Œæœ‰åºåŒ¹é…=0ï¼Œåæ˜ é¢‘æ¬¡ä¸€è‡´æ€§ï¼‰
 * itemConsistency: Number å…ƒç´ ä¸€è‡´æ€§ç³»æ•°ï¼š1 - itemErrorRateï¼ˆåæ˜ å…ƒç´ æ•´ä½“ä¸€è‡´æ€§ï¼Œ1=å…ƒç´ å®Œå…¨ç›¸åŒï¼‰
 * totalConsistency: Number æ•´ä½“ä¸€è‡´æ€§ç³»æ•°ï¼š(similarity + lenConsistency + itemConsistency)/3ï¼ˆç»¼åˆå¤šç»´åº¦çš„ä¸€è‡´æ€§ï¼Œæ›´å…¨é¢ï¼‰
 * ===================== ã€æå€¼ç»´åº¦æ¨¡å—ã€‘- å„ç»´åº¦æå€¼ç»Ÿè®¡ï¼ˆè¾…åŠ©å¼‚å¸¸åˆ¤æ–­ï¼‰ =====================
 * maxDiffItem: Number å•ç±»å…ƒç´ æœ€å¤§å·®å¼‚æ•°ï¼šæ— åº=ç‹¬æœ‰å…ƒç´ ä¸­æ•°é‡æœ€å¤šçš„å…ƒç´ æ•°ï¼›æœ‰åº=å•ä½ç½®æ— å·®å¼‚ï¼ˆ0ï¼‰
 * maxDiffFreq: Number å•å…ƒç´ æœ€å¤§é¢‘æ¬¡å·®å€¼ï¼šå…±åŒå…ƒç´ ä¸­é¢‘æ¬¡å·®å€¼çš„æœ€å¤§å€¼ï¼ˆæ— å…±åŒå…ƒç´ åˆ™=0ï¼‰
 * diffLenRatio: Number é•¿åº¦å·®å€¼å æ¯”ï¼šdiffLen/Math.max(len1,len2)ï¼ˆæœ€å¤§é•¿åº¦ä¸º0åˆ™=0ï¼Œåæ˜ é•¿åº¦å·®å€¼çš„ç›¸å¯¹æ¯”ä¾‹ï¼‰
 */
function getListSimilarity(arr1, arr2, options) {
    // ===== ğŸŒŸ çŠ€ç‰›å¼•æ“æ ¸å¿ƒé€‚é…ï¼šæ‰‹åŠ¨å¤„ç†é…ç½®é¡¹ï¼Œæ›¿ä»£å‚æ•°é»˜è®¤å€¼ï¼Œä¸¥æ ¼é˜²ä¼ å‚é”™è¯¯ =====
    var isOrdered = false;
    if (options !== undefined && options !== null && typeof options.isOrdered === "boolean") {
        isOrdered = options.isOrdered;
    }

    // ===== ğŸŒŸ åŸºç¡€é¢„å¤„ç†ï¼šéæ•°ç»„è½¬ç©ºåˆ—è¡¨+åˆå§‹åŒ–æ ¸å¿ƒè¿”å›å˜é‡ï¼Œå½»åº•é˜²è„šæœ¬å´©æºƒ =====
    var arr1Valid = Array.isArray(arr1) ? arr1 : [];
    var arr2Valid = Array.isArray(arr2) ? arr2 : [];
    var result = {
        // æ ¸å¿ƒç»“æœ
        similarity: 0,
        isOrdered: isOrdered,
        analysisState: "success",
        // æ€»æ•°ç»´åº¦
        len1: arr1Valid.length,
        len2: arr2Valid.length,
        diffLen: 0,
        sameLenFlag: false,
        totalItemCount: 0,
        lenRatio: 0,
        // é¢‘ç‡ç»´åº¦
        freq1: {},
        freq2: {},
        matchFreq: 0,
        totalFreq1: 0,
        totalFreq2: 0,
        maxFreq1: 0,
        maxFreq2: 0,
        minFreq1: 0,
        minFreq2: 0,
        // å·®å€¼ç»´åº¦
        diffItemCount: 0,
        diffFreqSum: 0,
        uniqueItem1: [],
        uniqueItem2: [],
        commonItems: [],
        unmatchIndex: [],
        // è¯¯å·®ç»´åº¦
        similarityError: 1,
        lenErrorRate: 0,
        freqErrorRate: 0,
        itemErrorRate: 0,
        // å æ¯”ç»´åº¦
        commonItemRatio: 0,
        matchFreqRatio1: 0,
        matchFreqRatio2: 0,
        matchFreqRatioTotal: 0,
        // ä¸€è‡´æ€§ç»´åº¦
        lenConsistency: 0,
        freqConsistency: 0,
        itemConsistency: 0,
        totalConsistency: 0,
        // æå€¼ç»´åº¦
        maxDiffItem: 0,
        maxDiffFreq: 0,
        diffLenRatio: 0
    };

    // ===== ğŸŒŸ æ€»æ•°ç»´åº¦åŸºç¡€è®¡ç®—ï¼šä¸€æ¬¡æ€§è®¡ç®—æ‰€æœ‰é•¿åº¦ç›¸å…³æŒ‡æ ‡ï¼Œé¿å…é‡å¤è¿ç®— =====
    var len1 = result.len1;
    var len2 = result.len2;
    result.totalItemCount = len1 + len2;
    result.diffLen = Math.abs(len1 - len2);
    result.sameLenFlag = len1 === len2;
    result.lenRatio = (len1 === 0 && len2 === 0) ? 1 : (Math.min(len1, len2) / Math.max(len1, len2));
    result.diffLenRatio = (Math.max(len1, len2) === 0) ? 0 : (result.diffLen / Math.max(len1, len2));
    result.totalFreq1 = len1;
    result.totalFreq2 = len2;

    // ===== ğŸŒŸ ç©ºåˆ—è¡¨è¾¹ç•Œå¤„ç†ï¼šå¿«é€Ÿè¿”å›ç»“æœï¼Œé¿å…æ— æ•ˆè®¡ç®—ï¼ˆåŒç©º/å•ç©ºåˆ†åˆ«å¤„ç†ï¼‰ =====
    if (len1 === 0 && len2 === 0) {
        result.analysisState = "empty_both";
        result.similarity = 1;
        result.similarityError = 0;
        result.sameLenFlag = true;
        result.lenRatio = 1;
        result.lenConsistency = 1;
        result.itemConsistency = 1;
        result.totalConsistency = 1;
        return result;
    }
    if (len1 === 0 || len2 === 0) {
        result.analysisState = "empty_single";
        result.diffItemCount = result.totalItemCount;
        result.itemErrorRate = 1;
        result.lenErrorRate = (result.totalItemCount === 0) ? 0 : (result.diffLen / result.totalItemCount);
        result.lenConsistency = 1 - result.lenErrorRate;
        result.itemConsistency = 1 - result.itemErrorRate;
        result.totalConsistency = (result.similarity + result.lenConsistency + result.itemConsistency) / 3;
        result.uniqueItem1 = arr1Valid;
        result.uniqueItem2 = arr2Valid;
        result.maxDiffItem = Math.max(len1, len2);
        return result;
    }

    // ===== ğŸŒŸ å·¥å…·å‡½æ•°1ï¼šç»Ÿè®¡å…ƒç´ é¢‘æ¬¡+æå–æå€¼ï¼ˆæœ€å¤§/æœ€å°é¢‘æ¬¡ï¼‰ï¼Œå¤ç”¨æ€§å¼º =====
    function getFreqWithExtreme(arr) {
        var freq = {};
        for (var i = 0; i < arr.length; i++) {
            var key = arr[i] + ""; // è½¬å­—ç¬¦ä¸²åšé”®ï¼Œå…¼å®¹æ‰€æœ‰åŸºç¡€ç±»å‹
            freq[key] = freq[key] ? freq[key] + 1 : 1;
        }
        // æå–é¢‘æ¬¡æå€¼
        var freqVals = Object.values(freq);
        var maxF = freqVals.length > 0 ? Math.max.apply(Math, freqVals) : 0;
        var minF = freqVals.length > 0 ? Math.min.apply(Math, freqVals) : 0;
        return {
            freqMap: freq,
            maxFreq: maxF,
            minFreq: minF
        };
    }

    // ===== ğŸŒŸ å·¥å…·å‡½æ•°2ï¼šè¿˜åŸå…ƒç´ åŸå§‹ç±»å‹ï¼ˆå­—ç¬¦ä¸²â†’æ•°å­—/å¸ƒå°”ï¼‰ï¼Œè§£å†³ç±»å‹ä¸¢å¤±é—®é¢˜ =====
    function restoreOriginalType(key) {
        if (key === "true") return true;
        if (key === "false") return false;
        if (!isNaN(Number(key)) && key !== "") return Number(key);
        return key; // å­—ç¬¦ä¸²ç›´æ¥è¿”å›
    }

    // ===== ğŸŒŸ åœºæ™¯1ï¼šæœ‰åºåŒ¹é…ï¼ˆé€ä½ä¸¥æ ¼åŒ¹é…ï¼Œåƒç´ 0/1åˆ—è¡¨æ ¸å¿ƒç”¨æ³•ï¼Œå…³æ³¨ä½ç½®+å€¼ï¼‰ =====
    if (isOrdered) {
        var matchCount = 0;
        var minLen = Math.min(len1, len2);
        var maxLen = Math.max(len1, len2);
        // é€ä½å¯¹æ¯”ï¼šè®°å½•åŒ¹é…æ•°+ä¸åŒ¹é…ä½ç½®ç´¢å¼•ï¼ˆç²¾å‡†å®šä½åƒç´ å·®å¼‚ï¼‰
        for (var i = 0; i < minLen; i++) {
            if (arr1Valid[i] === arr2Valid[i]) {
                matchCount++;
            } else {
                result.unmatchIndex.push(i);
            }
        }
        // æ ¸å¿ƒç›¸ä¼¼åº¦è®¡ç®—ï¼šåŒ¹é…æ•°/æœ€å¤§é•¿åº¦ï¼ˆé•¿åº¦ä¸åŒåˆ™ç›¸ä¼¼åº¦å¿…ç„¶<1ï¼‰
        result.similarity = matchCount / maxLen;
        // å·®å€¼ç»´åº¦ï¼šæ€»å·®å¼‚æ•°=é€ä½ä¸åŒ¹é…æ•°+é•¿åˆ—è¡¨å¤šä½™å…ƒç´ æ•°
        result.diffItemCount = result.unmatchIndex.length + result.diffLen;
        // é¢‘ç‡ç»´åº¦ï¼šæœ‰åºåŒ¹é…ä»…ç»Ÿè®¡æ€»é¢‘æ¬¡ï¼Œé¢‘æ¬¡æ˜ å°„è¡¨ç½®ç©ºï¼ˆæ— æ„ä¹‰ï¼‰
        result.matchFreq = matchCount;
        // å æ¯”ç»´åº¦ï¼šè®¡ç®—åŒ¹é…é¢‘æ¬¡å æ¯”
        result.matchFreqRatio1 = matchCount / len1;
        result.matchFreqRatio2 = matchCount / len2;
        result.matchFreqRatioTotal = matchCount / result.totalItemCount;
    }

    // ===== ğŸŒŸ åœºæ™¯2ï¼šæ— åºåŒ¹é…ï¼ˆé¢‘æ¬¡åŒ¹é…æ³•ï¼Œè†æ£˜åæ ‡åˆ—è¡¨æ ¸å¿ƒç”¨æ³•ï¼Œä»…å…³æ³¨å…ƒç´ ï¼‰ =====
    if (!isOrdered) {
        // ç»Ÿè®¡ä¸¤ä¸ªåˆ—è¡¨çš„é¢‘æ¬¡+æå€¼
        var freqRes1 = getFreqWithExtreme(arr1Valid);
        var freqRes2 = getFreqWithExtreme(arr2Valid);
        result.freq1 = freqRes1.freqMap;
        result.freq2 = freqRes2.freqMap;
        result.maxFreq1 = freqRes1.maxFreq;
        result.minFreq1 = freqRes1.minFreq;
        result.maxFreq2 = freqRes2.maxFreq;
        result.minFreq2 = freqRes2.minFreq;

        var freq1Keys = Object.keys(result.freq1);
        var freq2Keys = Object.keys(result.freq2);
        var totalTypeCount = new Set(freq1Keys.concat(freq2Keys)).size; // æ€»å…ƒç´ ç§ç±»æ•°

        // éå†arr1é¢‘æ¬¡ï¼šè®¡ç®—å…±åŒå…ƒç´ åŒ¹é…é¢‘æ¬¡+é¢‘æ¬¡å·®å€¼+å…±åŒå…ƒç´ +arr1ç‹¬æœ‰å…ƒç´ 
        for (var k = 0; k < freq1Keys.length; k++) {
            var key = freq1Keys[k];
            var val1 = result.freq1[key];
            if (result.freq2.hasOwnProperty(key)) {
                var val2 = result.freq2[key];
                result.matchFreq += Math.min(val1, val2); // åŒ¹é…é¢‘æ¬¡å–æœ€å°å€¼
                var diffFreq = Math.abs(val1 - val2);
                result.diffFreqSum += diffFreq; // é¢‘æ¬¡å·®å€¼æ±‚å’Œ
                // æ›´æ–°å•å…ƒç´ æœ€å¤§é¢‘æ¬¡å·®å€¼
                if (diffFreq > result.maxDiffFreq) result.maxDiffFreq = diffFreq;
                // åŠ å…¥å…±åŒå…ƒç´ åˆ—è¡¨ï¼ˆè¿˜åŸåŸå§‹ç±»å‹ï¼‰
                result.commonItems.push(restoreOriginalType(key));
            } else {
                // arr1ç‹¬æœ‰å…ƒç´ ï¼ˆè¿˜åŸåŸå§‹ç±»å‹ï¼ŒæŒ‰é¢‘æ¬¡æ·»åŠ ï¼Ÿä¸ï¼Œä»…å­˜å…ƒç´ å€¼ï¼‰
                result.uniqueItem1.push(restoreOriginalType(key));
            }
        }

        // éå†arr2é¢‘æ¬¡ï¼šæå–arr2ç‹¬æœ‰å…ƒç´ ï¼ˆæ’é™¤å…±åŒå…ƒç´ ï¼‰
        for (var m = 0; m < freq2Keys.length; m++) {
            var key2 = freq2Keys[m];
            if (!result.freq1.hasOwnProperty(key2)) {
                result.uniqueItem2.push(restoreOriginalType(key2));
            }
        }

        // å·®å€¼ç»´åº¦ï¼šæ€»å·®å¼‚å…ƒç´ æ•°=ç‹¬æœ‰å…ƒç´ æ•°ä¹‹å’Œï¼Œæœ€å¤§å·®å¼‚å…ƒç´ æ•°=ç‹¬æœ‰å…ƒç´ æ•°çš„æœ€å¤§å€¼
        result.diffItemCount = result.uniqueItem1.length + result.uniqueItem2.length;
        result.maxDiffItem = Math.max(result.uniqueItem1.length, result.uniqueItem2.length);
        // å æ¯”ç»´åº¦ï¼šå…±åŒå…ƒç´ å æ¯”=å…±åŒå…ƒç´ æ•°/æ€»å…ƒç´ ç§ç±»æ•°
        result.commonItemRatio = totalTypeCount === 0 ? 0 : (result.commonItems.length / totalTypeCount);
        // å æ¯”ç»´åº¦ï¼šåŒ¹é…é¢‘æ¬¡å æ¯”
        result.matchFreqRatio1 = result.matchFreq / len1;
        result.matchFreqRatio2 = result.matchFreq / len2;
        result.matchFreqRatioTotal = result.matchFreq / result.totalItemCount;
        // é¢‘æ¬¡è¯¯å·®ç‡ï¼šæ€»å…±åŒé¢‘æ¬¡å’Œ=åŒ¹é…é¢‘æ¬¡+é¢‘æ¬¡å·®å€¼/2ï¼Œæ— å…±åŒå…ƒç´ åˆ™è¯¯å·®ç‡=1
        var totalCommonFreq = result.matchFreq + Math.floor(result.diffFreqSum / 2);
        result.freqErrorRate = result.commonItems.length === 0 ? 1 : (totalCommonFreq === 0 ? 0 : (result.diffFreqSum / totalCommonFreq));
        // é¢‘æ¬¡ä¸€è‡´æ€§ç³»æ•°
        result.freqConsistency = 1 - result.freqErrorRate;

        // æ ¸å¿ƒç›¸ä¼¼åº¦è®¡ç®—ï¼šåŒ¹é…é¢‘æ¬¡/å¹³å‡é•¿åº¦ï¼ˆä¿è¯æ€»æ•°ç›¸åŒå€¼ä¸åŒåˆ™ç›¸ä¼¼åº¦<1ï¼‰
        var avgLen = result.totalItemCount / 2;
        result.similarity = result.matchFreq / avgLen;
    }

    // ===== ğŸŒŸ å…¨å±€ç»´åº¦è®¡ç®—ï¼šè¯¯å·®/ä¸€è‡´æ€§/æå€¼ï¼ˆæœ‰åº/æ— åºé€šç”¨ï¼Œä¸€æ¬¡æ€§è®¡ç®—ï¼‰ =====
    // è¯¯å·®ç»´åº¦ï¼šæ ¸å¿ƒç›¸ä¼¼åº¦è¯¯å·®+é•¿åº¦è¯¯å·®+å…ƒç´ è¯¯å·®
    result.similarity = Math.max(0, Math.min(1, result.similarity)); // å¼ºåˆ¶é™åˆ¶0~1ï¼Œé˜²æµ®ç‚¹ç²¾åº¦è¶…ç•Œ
    result.similarityError = 1 - result.similarity;
    result.lenErrorRate = result.totalItemCount === 0 ? 0 : (result.diffLen / result.totalItemCount);
    result.itemErrorRate = result.totalItemCount === 0 ? 0 : (result.diffItemCount / result.totalItemCount);
    // ä¸€è‡´æ€§ç»´åº¦ï¼šé•¿åº¦+å…ƒç´ +æ•´ä½“ï¼ˆæœ‰åºåŒ¹é…é¢‘æ¬¡ä¸€è‡´æ€§=0ï¼‰
    result.lenConsistency = 1 - result.lenErrorRate;
    result.itemConsistency = 1 - result.itemErrorRate;
    result.totalConsistency = (result.similarity + result.lenConsistency + result.itemConsistency) / 3;
    // ç©ºå€¼é˜²æŠ¤ï¼šæœ‰åºåŒ¹é…é¢‘æ¬¡ç›¸å…³å­—æ®µç½®0ï¼ˆæ— æ„ä¹‰ï¼‰
    if (isOrdered) {
        result.freqErrorRate = 0;
        result.freqConsistency = 0;
        result.commonItemRatio = 0;
    }

    // ===== ğŸŒŸ æœ€ç»ˆè¿”å›ï¼šè¶…å…¨ç»´åº¦ç»Ÿè®¡ç»“æœï¼Œç›´æ¥ç”¨äºä¸šåŠ¡å±‚åˆ¤æ–­ =====
    return result;
}

